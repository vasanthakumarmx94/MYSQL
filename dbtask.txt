Display emp details order with sal desc where job is CLERK or PRESIDENT.
Display emp who do need report to anybody.
Display empno,ename,sal who reports to a manager and salary is between 2000 and 6000. Show top 5 records only.
Display emp with emp id ordering asc who have managers
Display emp details with sal decremented by 10% as newsal for emp who have managers.
Display ename,sal of emps where 3rd character in name is 'R' and job is SALESMAN.




USE mydb;

-- All columns
SELECT * FROM EMP;

-- adding extra column
SELECT *,EMPNO FROM EMP;

-- fetching specific columns
SELECT JOB,SAL,DEPTNO FROM EMP;

SELECT EMPNO,SAL AS oldsal, (SAL*1.05) AS newsal FROM EMP;

SELECT 100*1.05 AS RESULT;

SELECT EMPNO,SAL FROM EMP ORDER BY EMPNO,SAL;

SELECT empno,ename FROM emp WHERE sal>1200 ORDER BY empno DESC;

SELECT * FROM EMP;

SELECT * FROM EMP WHERE SAL>800 AND SAL<3000 AND DEPTNO>20;

SELECT * FROM EMP WHERE SAL<1000 OR SAL>1600 ORDER BY EMPNO DESC;

SELECT * FROM EMP WHERE SAL BETWEEN 1200 AND 1600;

SELECT * FROM EMP WHERE SAL NOT BETWEEN 1200 AND 1600;

SELECT * FROM EMP WHERE JOB IN('CLERK','MANAGER','PRESIDENT');

SELECT * FROM EMP WHERE JOB NOT IN('CLERK','MANAGER','PRESIDENT');

SELECT * FROM EMP WHERE JOB IN('CLERK','MANAGER','PRESIDENT') AND DEPTNO > 20;

SELECT * FROM EMP WHERE SAL IN(1600,1250,3000) AND DEPTNO > 20;

SELECT ENAME FROM EMP WHERE ENAME LIKE 'A%';

SELECT ENAME FROM EMP WHERE ENAME LIKE '_A%';
SELECT * FROM EMP WHERE ENAME LIKE '_AR%';
SELECT ENAME FROM EMP WHERE ENAME LIKE '%D';

SELECT * FROM EMP LIMIT 5;

SELECT * FROM EMP WHERE JOB IN('CLERK','MANAGER','PRESIDENT') ORDER BY EMPNO LIMIT 2,5;

SELECT DISTINCT COMM FROM EMP;

SELECT * FROM EMP WHERE COMM IS NULL AND MGR IS NOT NULL;

SELECT e.ENAME as employee_name,e.sal as salary FROM EMP e;

SELECT MAX(SAL) AS MAXSAL,MIN(SAL) AS MINSAL,AVG(SAL) AS AVGSAL FROM EMP;

SELECT MAX(SAL) FROM EMP;

-- Highest sal emp details
SELECT * FROM EMP WHERE SAL = (SELECT MAX(SAL) FROM EMP);

-- Second highest sal emp details
SELECT * FROM EMP 
WHERE 
SAL =  -- COMPARES
	(SELECT MAX(SAL) FROM EMP -- MAX I.E 2ND HIGHEST
		WHERE SAL <  -- < HIGHEST
			(SELECT MAX(SAL) FROM EMP)); -- HIGHEST

SELECT E.ENAME FROM (SELECT * FROM EMP WHERE SAL < 3000) AS E;
            
DESCRIBE emp;

DESCRIBE dept;

SELECT E.EMPNO,E.SAL,D.DNAME,D.LOC
FROM EMP E
INNER JOIN DEPT D ON E.DEPTNO=D.DEPTNO;

SELECT COUNT(*) FROM (SELECT E.*,D.LOC
FROM EMP E
INNER JOIN DEPT D USING (DEPTNO)) X;

SELECT COUNT(*) FROM EMP; -- 14
SELECT COUNT(*) FROM DEPT; -- 4

SELECT *
FROM EMP E
LEFT JOIN DEPT D USING (DEPTNO);

SELECT *
FROM EMP E
LEFT JOIN DEPT D USING (DEPTNO) WHERE D.DEPTNO IS NULL;

SELECT *
FROM EMP E
RIGHT JOIN DEPT D USING (DEPTNO) WHERE E.DEPTNO IS NULL;

SELECT * FROM DEPT;

SELECT COUNT(*) FROM (
SELECT E.*,D.LOC
FROM EMP E
CROSS JOIN DEPT D) X;

-- 15x5 = 75

SELECT * FROM DEPT LIMIT 1;

INSERT INTO EMP VALUES(111,'xyz','clerk',null,null,2000,null,50);


SELECT * FROM t1
LEFT JOIN t2 ON t1.id = t2.id
UNION
SELECT * FROM t1
RIGHT JOIN t2 ON t1.id = t2.id;  -- FULL OUTER JOIN

SELECT *
FROM EMP E
LEFT JOIN DEPT D USING (DEPTNO) 
UNION 
SELECT *
FROM EMP E
RIGHT JOIN DEPT D USING (DEPTNO); 


